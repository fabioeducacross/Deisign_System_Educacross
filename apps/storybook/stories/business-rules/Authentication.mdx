import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Regras de Neg√≥cio/Autentica√ß√£o" />

# Regras de Autentica√ß√£o e Seguran√ßa

## Vis√£o Geral

Este documento define as regras de autentica√ß√£o, autoriza√ß√£o e seguran√ßa da plataforma Educacross.

---

## 1. Pol√≠tica de Senhas

### üîí RN-AUTH-001: Complexidade de Senha

**Descri√ß√£o**: Toda senha deve atender aos crit√©rios m√≠nimos de seguran√ßa.

**Regras**:
- M√≠nimo de 8 caracteres
- Pelo menos 1 letra mai√∫scula
- Pelo menos 1 letra min√∫scula
- Pelo menos 1 n√∫mero
- Pelo menos 1 caractere especial (@, #, $, %, etc.)

**Valida√ß√£o**: Executada no frontend e backend

**Exemplo v√°lido**:
```
Educacross@2026
Senha#Forte123
```

**Exemplo inv√°lido**:
```
senha123        (sem mai√∫scula, sem especial)
SENHA           (sem min√∫scula, sem n√∫mero, sem especial)
12345678        (apenas n√∫meros)
```

**Exce√ß√£o**: Senhas tempor√°rias geradas pelo sistema t√™m validade de 24 horas e for√ßam troca no primeiro login.

---

### ‚ö†Ô∏è RN-AUTH-002: Expira√ß√£o de Senha

**Descri√ß√£o**: Senhas devem ser renovadas periodicamente.

**Regras**:
- Senha expira ap√≥s 90 dias para usu√°rios comuns
- Senha expira ap√≥s 60 dias para administradores
- Sistema avisa com 7 dias de anteced√™ncia
- Ap√≥s expira√ß√£o, usu√°rio n√£o consegue fazer login at√© renovar

**Exce√ß√£o**: Contas de servi√ßo (APIs) n√£o t√™m expira√ß√£o autom√°tica.

---

### üîí RN-AUTH-003: Hist√≥rico de Senhas

**Descri√ß√£o**: Usu√°rio n√£o pode reutilizar senhas antigas.

**Regras**:
- Sistema armazena hash das √∫ltimas 5 senhas
- Nova senha n√£o pode ser igual a nenhuma das 5 anteriores

---

## 2. Controle de Sess√£o

### üîí RN-AUTH-004: Tempo de Sess√£o

**Descri√ß√£o**: Sess√µes inativas s√£o encerradas automaticamente.

**Regras**:
- Sess√£o expira ap√≥s 30 minutos de inatividade
- Usu√°rio recebe aviso 2 minutos antes da expira√ß√£o
- M√∫ltiplas sess√µes por usu√°rio s√£o permitidas (m√°ximo 3 dispositivos simult√¢neos)

**Exce√ß√£o**: Administradores podem configurar tempo customizado por papel.

---

### ‚ö†Ô∏è RN-AUTH-005: Logout Autom√°tico

**Descri√ß√£o**: Sistema faz logout autom√°tico em situa√ß√µes espec√≠ficas.

**Gatilhos**:
- Inatividade por 30 minutos
- Detec√ß√£o de sess√£o em novo dispositivo (quando exceder limite)
- Mudan√ßa de senha ou permiss√µes
- Suspeita de fraude detectada pelo sistema

---

## 3. Tentativas de Login

### üîí RN-AUTH-006: Bloqueio por Tentativas Falhas

**Descri√ß√£o**: Protege contra ataques de for√ßa bruta.

**Regras**:
- Ap√≥s 3 tentativas falhas consecutivas: CAPTCHA obrigat√≥rio
- Ap√≥s 5 tentativas falhas: conta bloqueada por 15 minutos
- Ap√≥s 10 tentativas falhas: conta bloqueada at√© interven√ß√£o de administrador

**Notifica√ß√£o**: Email enviado ao usu√°rio em cada tentativa falha.

---

## 4. Autentica√ß√£o Multifator (MFA)

### ‚ÑπÔ∏è RN-AUTH-007: MFA Opcional

**Descri√ß√£o**: MFA pode ser habilitado pelo usu√°rio.

**M√©todos suportados**:
- Email (c√≥digo de 6 d√≠gitos)
- SMS (c√≥digo de 6 d√≠gitos)
- Aplicativo autenticador (TOTP)

**Regras**:
- C√≥digo expira em 5 minutos
- M√°ximo de 3 tentativas por c√≥digo
- C√≥digo s√≥ pode ser usado uma vez

---

### üîí RN-AUTH-008: MFA Obrigat√≥rio para Administradores

**Descri√ß√£o**: Administradores devem usar MFA.

**Regras**:
- Administrador n√£o consegue acessar painel sem MFA ativo
- Deve configurar MFA no primeiro login ap√≥s promo√ß√£o
- Requer reautentica√ß√£o MFA a cada 8 horas

---

## 5. Recupera√ß√£o de Senha

### ‚ö†Ô∏è RN-AUTH-009: Processo de Recupera√ß√£o

**Descri√ß√£o**: Usu√°rio pode recuperar senha via email.

**Fluxo**:
1. Usu√°rio solicita recupera√ß√£o
2. Sistema envia link √∫nico para email cadastrado
3. Link expira em 1 hora
4. Usu√°rio cria nova senha seguindo RN-AUTH-001

**Seguran√ßa**:
- Link s√≥ pode ser usado uma vez
- IP da solicita√ß√£o √© registrado
- Email de confirma√ß√£o √© enviado ap√≥s troca bem-sucedida

---

## 6. Permiss√µes e Autoriza√ß√£o

### üîí RN-AUTH-010: Princ√≠pio do Menor Privil√©gio

**Descri√ß√£o**: Usu√°rios t√™m apenas as permiss√µes necess√°rias para suas fun√ß√µes.

**Pap√©is base**:
- **Aluno**: visualizar cursos, materiais, notas
- **Professor**: gerenciar turmas, lan√ßar notas, criar conte√∫do
- **Coordenador**: aprovar conte√∫do, relat√≥rios de turmas
- **Administrador**: configura√ß√µes do sistema, gest√£o de usu√°rios

**Regra**: Nenhum papel herda automaticamente permiss√µes de outro.

---

### ‚ö†Ô∏è RN-AUTH-011: Delega√ß√£o de Permiss√µes

**Descri√ß√£o**: Administrador pode delegar permiss√µes tempor√°rias.

**Regras**:
- Delega√ß√£o tem data de in√≠cio e fim obrigat√≥rias
- M√°ximo de 90 dias por delega√ß√£o
- Sistema revoga automaticamente ao expirar
- Todas as a√ß√µes com permiss√£o delegada s√£o auditadas

---

## Refer√™ncias

- **Jornada**: [Login e Autentica√ß√£o](../?path=/docs/jornadas-autenticacao--docs)
- **Casos de Uso**: [UC-001: Login de Usu√°rio](../?path=/docs/casos-de-uso-autenticacao--docs)
- **C√≥digo**: `packages/ui/src/components/LoginForm/`

---

**√öltima atualiza√ß√£o**: 14 de janeiro de 2026  
**Respons√°vel**: Equipe de Seguran√ßa  
**Revis√£o**: Mensal
