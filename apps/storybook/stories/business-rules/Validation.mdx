import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Regras de Neg√≥cio/Valida√ß√µes" />

# Regras de Valida√ß√£o de Dados

## Vis√£o Geral

Este documento define as regras de valida√ß√£o para entrada de dados em formul√°rios, APIs e processos da plataforma.

---

## 1. Dados de Usu√°rio

### üîí RN-VAL-001: CPF

**Descri√ß√£o**: CPF deve ser v√°lido e √∫nico.

**Regras**:
- Formato: 11 d√≠gitos num√©ricos
- Deve passar valida√ß√£o de d√≠gito verificador
- Deve ser √∫nico no sistema (n√£o pode cadastrar CPF duplicado)
- Aceita com ou sem formata√ß√£o (pontos e h√≠fen)

**Valida√ß√£o**:
```typescript
// Exemplo de formato aceito
"12345678901"        // ‚úÖ V√°lido
"123.456.789-01"     // ‚úÖ V√°lido (sistema remove formata√ß√£o)
"000.000.000-00"     // ‚ùå CPF inv√°lido
"12345678"           // ‚ùå Menos de 11 d√≠gitos
```

**Mensagem de erro**:
- "CPF inv√°lido. Verifique os d√≠gitos informados."
- "Este CPF j√° est√° cadastrado no sistema."

---

### üîí RN-VAL-002: Email

**Descri√ß√£o**: Email deve ser v√°lido e √∫nico.

**Regras**:
- Formato RFC 5322 compliant
- Deve ter @ e dom√≠nio v√°lido
- M√°ximo 254 caracteres
- Deve ser √∫nico no sistema
- Sistema converte para lowercase automaticamente

**Valida√ß√£o**:
```typescript
"usuario@educacross.com"        // ‚úÖ V√°lido
"nome.sobrenome@empresa.com.br" // ‚úÖ V√°lido
"email@dominio"                 // ‚ùå Sem TLD
"@dominio.com"                  // ‚ùå Sem parte local
"email com espa√ßo@site.com"     // ‚ùå Espa√ßo n√£o permitido
```

**Verifica√ß√£o adicional**: Sistema envia email de confirma√ß√£o (RN-VAL-003).

---

### ‚ö†Ô∏è RN-VAL-003: Confirma√ß√£o de Email

**Descri√ß√£o**: Email deve ser verificado antes de ativa√ß√£o completa.

**Processo**:
1. Usu√°rio cadastra email
2. Sistema envia link de confirma√ß√£o
3. Link expira em 24 horas
4. Usu√°rio tem acesso limitado at√© confirmar
5. Ap√≥s 7 dias sem confirma√ß√£o, conta √© desativada

---

### üîí RN-VAL-004: Telefone

**Descri√ß√£o**: Telefone deve seguir formato brasileiro.

**Regras**:
- Formato: (XX) XXXXX-XXXX ou (XX) XXXX-XXXX
- DDD deve ser v√°lido (11 a 99)
- Celular deve ter 9 d√≠gitos (primeiro d√≠gito 9)
- Telefone fixo deve ter 8 d√≠gitos

**Valida√ß√£o**:
```typescript
"(11) 98765-4321"  // ‚úÖ Celular v√°lido
"(11) 3456-7890"   // ‚úÖ Fixo v√°lido
"11987654321"      // ‚úÖ V√°lido (sistema formata)
"(00) 98765-4321"  // ‚ùå DDD inv√°lido
"(11) 8765-4321"   // ‚ùå Celular com 8 d√≠gitos
```

---

### ‚ÑπÔ∏è RN-VAL-005: Nome Completo

**Descri√ß√£o**: Nome deve ter nome e sobrenome.

**Regras**:
- M√≠nimo 2 palavras (nome + sobrenome)
- M√≠nimo 3 caracteres por palavra
- M√°ximo 100 caracteres total
- Apenas letras, espa√ßos, h√≠fen e ap√≥strofo
- Sistema capitaliza automaticamente (Title Case)

**Valida√ß√£o**:
```typescript
"Jo√£o Silva"           // ‚úÖ V√°lido
"Maria de Souza"       // ‚úÖ V√°lido
"Jean-Paul D'Angelo"   // ‚úÖ V√°lido
"Jo√£o"                 // ‚ùå Falta sobrenome
"J. Silva"             // ‚ùå Nome com menos de 3 caracteres
"Jo√£o123 Silva"        // ‚ùå N√∫meros n√£o permitidos
```

---

### üîí RN-VAL-006: Data de Nascimento

**Descri√ß√£o**: Data de nascimento deve ser v√°lida e dentro de limites.

**Regras**:
- Formato: DD/MM/AAAA
- Idade m√≠nima: 16 anos (RN-VAL-007)
- Idade m√°xima: 120 anos
- Data n√£o pode ser futura
- Deve ser data v√°lida do calend√°rio

**Valida√ß√£o**:
```typescript
"15/03/2005"  // ‚úÖ V√°lido (19 anos)
"31/02/2000"  // ‚ùå Data inv√°lida
"15/03/2010"  // ‚ùå Menor de 16 anos
"01/01/1900"  // ‚ùå Mais de 120 anos
"15/03/2027"  // ‚ùå Data futura
```

---

### ‚ö†Ô∏è RN-VAL-007: Idade M√≠nima

**Descri√ß√£o**: Aluno deve ter idade m√≠nima para matr√≠cula.

**Regras**:
- Idade m√≠nima padr√£o: 16 anos
- Cursos podem ter idade m√≠nima espec√≠fica (configur√°vel por curso)
- Idade √© calculada na data da matr√≠cula, n√£o cadastro

**Exce√ß√£o**: Cursos de extens√£o podem ter idade m√≠nima de 14 anos com autoriza√ß√£o de respons√°vel.

---

## 2. Dados Acad√™micos

### üîí RN-VAL-008: C√≥digo de Curso

**Descri√ß√£o**: C√≥digo do curso deve seguir padr√£o institucional.

**Regras**:
- Formato: 3 letras + 4 d√≠gitos (ex: TEC-2024)
- Letras representam √°rea
- D√≠gitos representam sequ√™ncia e ano
- Deve ser √∫nico no sistema

**Exemplos**:
```typescript
"TEC-2024"  // ‚úÖ Tecnologia 2024
"ADM-2025"  // ‚úÖ Administra√ß√£o 2025
"ENG-2024"  // ‚úÖ Engenharia 2024
"TEC2024"   // ‚ùå Falta h√≠fen
"T-2024"    // ‚ùå Menos de 3 letras
```

---

### ‚ÑπÔ∏è RN-VAL-009: Carga Hor√°ria

**Descri√ß√£o**: Curso deve ter carga hor√°ria v√°lida.

**Regras**:
- M√≠nimo: 20 horas
- M√°ximo: 4000 horas
- Deve ser m√∫ltiplo de 2 (aulas de 2 horas)
- Carga total = soma das disciplinas

**Valida√ß√£o**:
```typescript
40    // ‚úÖ V√°lido
100   // ‚úÖ V√°lido
35    // ‚ùå N√£o √© m√∫ltiplo de 2
10    // ‚ùå Menos de 20 horas
5000  // ‚ùå Mais de 4000 horas
```

---

### üîí RN-VAL-010: Nota

**Descri√ß√£o**: Notas devem estar em escala de 0 a 10.

**Regras**:
- Escala: 0.0 a 10.0
- Precis√£o: 1 casa decimal
- Nota m√≠nima para aprova√ß√£o: 7.0 (configur√°vel por curso)
- Valor nulo representa "n√£o avaliado"

**Valida√ß√£o**:
```typescript
10.0   // ‚úÖ V√°lido
7.5    // ‚úÖ V√°lido
0.0    // ‚úÖ V√°lido (reprovado)
10.5   // ‚ùå Acima do m√°ximo
-1.0   // ‚ùå Negativo
7.55   // ‚ùå Mais de 1 casa decimal
```

---

### ‚ö†Ô∏è RN-VAL-011: Frequ√™ncia

**Descri√ß√£o**: Frequ√™ncia deve estar entre 0% e 100%.

**Regras**:
- Formato: n√∫mero inteiro de 0 a 100
- Frequ√™ncia m√≠nima para aprova√ß√£o: 75% (RN-VAL-012)
- Calculada automaticamente por presen√ßas registradas
- N√£o pode ser editada manualmente (apenas via registro de presen√ßa)

---

### üîí RN-VAL-012: Crit√©rios de Aprova√ß√£o

**Descri√ß√£o**: Aluno deve atender todos os crit√©rios para aprova√ß√£o.

**Crit√©rios obrigat√≥rios**:
- Nota final ‚â• 7.0 (ou m√©dia configurada)
- Frequ√™ncia ‚â• 75%
- Atividades obrigat√≥rias entregues
- Sem pend√™ncias financeiras (se aplic√°vel)

**Status poss√≠veis**:
- **Aprovado**: Atende todos os crit√©rios
- **Reprovado por nota**: Nota < 7.0
- **Reprovado por falta**: Frequ√™ncia < 75%
- **Reprovado por pend√™ncia**: Atividades n√£o entregues

---

## 3. Dados de Conte√∫do

### ‚ÑπÔ∏è RN-VAL-013: Upload de Arquivo

**Descri√ß√£o**: Arquivos devem atender limites e formatos.

**Regras gerais**:
- Tamanho m√°ximo por arquivo: 50 MB
- Tamanho m√°ximo por upload (m√∫ltiplos): 200 MB
- Nome do arquivo: m√°ximo 255 caracteres

**Formatos permitidos por tipo**:

| Tipo | Formatos | Uso |
|------|----------|-----|
| Documento | .pdf, .doc, .docx, .txt | Materiais did√°ticos |
| Apresenta√ß√£o | .ppt, .pptx, .odp | Slides de aula |
| Planilha | .xls, .xlsx, .ods, .csv | Dados e exerc√≠cios |
| Imagem | .jpg, .jpeg, .png, .gif | Ilustra√ß√µes |
| V√≠deo | .mp4, .avi, .mov | Aulas gravadas |
| √Åudio | .mp3, .wav | Podcasts |
| Arquivo compactado | .zip, .rar, .7z | Pacotes de materiais |

**Valida√ß√£o**:
```typescript
"aula.pdf"            // ‚úÖ V√°lido
"video-aula.mp4"      // ‚úÖ V√°lido
"exercicio.xlsx"      // ‚úÖ V√°lido
"script.exe"          // ‚ùå Formato n√£o permitido
"arquivo_com_60MB.zip" // ‚ùå Excede tamanho m√°ximo
```

**Seguran√ßa**: Sistema faz scan antiv√≠rus antes de aceitar upload.

---

### üîí RN-VAL-014: T√≠tulo de Conte√∫do

**Descri√ß√£o**: Conte√∫do deve ter t√≠tulo descritivo.

**Regras**:
- M√≠nimo: 5 caracteres
- M√°ximo: 200 caracteres
- Deve ser √∫nico dentro da disciplina
- N√£o pode conter apenas n√∫meros

---

### ‚ÑπÔ∏è RN-VAL-015: Descri√ß√£o de Conte√∫do

**Descri√ß√£o**: Conte√∫do deve ter descri√ß√£o clara.

**Regras**:
- M√≠nimo: 20 caracteres
- M√°ximo: 2000 caracteres
- Markdown permitido
- Links externos devem ter protocolo (http:// ou https://)

---

## 4. Valida√ß√µes de Formul√°rio

### ‚ö†Ô∏è RN-VAL-016: Campos Obrigat√≥rios

**Descri√ß√£o**: Sistema indica claramente campos obrigat√≥rios.

**Padr√£o**:
- Campo obrigat√≥rio marcado com asterisco (*) vermelho
- Mensagem de erro exibida ao tentar submeter sem preencher
- Campo fica com borda vermelha quando inv√°lido

**Mensagem padr√£o**: "Este campo √© obrigat√≥rio"

---

### ‚ÑπÔ∏è RN-VAL-017: Valida√ß√£o em Tempo Real

**Descri√ß√£o**: Sistema valida campos enquanto usu√°rio digita.

**Comportamento**:
- Valida√ß√£o ocorre ao perder foco (onBlur)
- Mensagem de erro aparece abaixo do campo
- Campo v√°lido mostra √≠cone de check verde
- Campo inv√°lido mostra √≠cone de X vermelho

---

### üîí RN-VAL-018: Confirma√ß√£o de Senha

**Descri√ß√£o**: Formul√°rios de senha requerem confirma√ß√£o.

**Regras**:
- Campo "Confirmar Senha" obrigat√≥rio
- Deve ser id√™ntico ao campo "Senha"
- Valida√ß√£o ocorre em tempo real
- Bot√£o de submit desabilitado enquanto senhas n√£o coincidem

---

## 5. Valida√ß√µes de API

### üîí RN-VAL-019: Valida√ß√£o no Backend

**Descri√ß√£o**: Todas as valida√ß√µes de frontend s√£o revalidadas no backend.

**Motivo**: Seguran√ßa - frontend pode ser manipulado.

**Resposta de erro**:
```json
{
  "error": "ValidationError",
  "message": "Dados inv√°lidos",
  "fields": {
    "email": "Email inv√°lido",
    "cpf": "CPF j√° cadastrado"
  }
}
```

---

### ‚ö†Ô∏è RN-VAL-020: Rate Limiting

**Descri√ß√£o**: API limita requisi√ß√µes por usu√°rio/IP.

**Limites**:
- Endpoints p√∫blicos: 100 requisi√ß√µes/minuto
- Endpoints autenticados: 1000 requisi√ß√µes/minuto
- Login: 5 tentativas/minuto

**Resposta quando excedido**:
```json
{
  "error": "RateLimitExceeded",
  "message": "Muitas requisi√ß√µes. Tente novamente em 60 segundos.",
  "retryAfter": 60
}
```

---

## Refer√™ncias

- **Componentes**: [Input](../?path=/docs/componentes-input--docs), [Select](../?path=/docs/componentes-select--docs)
- **Jornadas**: [Cadastro de Usu√°rio](../?path=/docs/jornadas-cadastro--docs)
- **Casos de Uso**: [UC-002: Cadastrar Aluno](../?path=/docs/casos-de-uso-usuarios--docs)

---

**√öltima atualiza√ß√£o**: 14 de janeiro de 2026  
**Respons√°vel**: Equipe de Qualidade  
**Revis√£o**: Bimestral
